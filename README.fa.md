# راهنمای نصب و راه‌اندازی پروژه Next.js + WordPress

این پروژه یک استارتر کیت (Starter Kit) برای استفاده از Next.js به عنوان فرانت‌اند و وردپرس به عنوان یک سیستم مدیریت محتوای Headless است. در این راهنما، مراحل کامل راه‌اندازی پروژه، از جمله تنظیمات سمت وردپرس و اجرای پروژه Next.js، به تفصیل توضیح داده شده است.

## پیش‌نیازها

- **Node.js**: نسخه 18 یا بالاتر
- **pnpm**: به عنوان پکیج منیجر (می‌توانید از `npm` یا `yarn` نیز استفاده کنید)
- **یک سایت وردپرسی**: این سایت به عنوان بک‌اند و منبع محتوا عمل خواهد کرد.

---

## مرحله ۱: تنظیمات سمت وردپرس

برای اینکه پروژه Next.js بتواند با وردپرس ارتباط برقرار کرده و کاربران را احراز هویت کند، باید یک افزونه خاص را نصب و پیکربندی کنید.

### نصب افزونه JWT Authentication

1.  وارد پیشخوان وردپرس خود شوید.
2.  به بخش **افزونه‌ها > افزودن** بروید.
3.  عبارت **"JWT Authentication for WP REST API"** را جستجو کنید.
4.  افزونه را نصب و فعال کنید.

### پیکربندی افزونه JWT

پس از فعال‌سازی، باید یک کلید مخفی (Secret Key) برای تولید و اعتبارسنجی توکن‌های JWT تعریف کنید. این کلید باید بین وردپرس و پروژه Next.js شما مشترک باشد.

1.  فایل `wp-config.php` سایت وردپرسی خود را باز کنید. (این فایل در روت هاست شما قرار دارد).
2.  کد زیر را به این فایل اضافه کنید. بهتر است آن را قبل از خط `/* That's all, stop editing! Happy publishing. */` قرار دهید.

    ```php
    define('JWT_AUTH_SECRET_KEY', 'your-super-secret-key');
    ```

    **نکته بسیار مهم**: به جای `your-super-secret-key` یک رشته تصادفی، طولانی و امن قرار دهید. می‌توانید از تولیدکننده‌های آنلاین رمز عبور برای ساخت یک کلید قوی استفاده کنید. **این کلید را در جایی امن ذخیره کنید**، زیرا در مرحله بعد در پروژه Next.js به آن نیاز خواهید داشت.

### فعال‌سازی CORS (اختیاری اما پیشنهادی)

برای جلوگیری از بروز خطای CORS (Cross-Origin Resource Sharing) هنگامی که پروژه Next.js شما از یک دامنه دیگر به API وردپرس درخواست می‌فرستد، کد زیر را نیز به فایل `wp-config.php` اضافه کنید:

```php
define('JWT_AUTH_CORS_ENABLE', true);
```

---

## مرحله ۲: تنظیمات پروژه Next.js

حالا نوبت به راه‌اندازی پروژه Next.js می‌رسد.

### ۱. کلون کردن و نصب وابستگی‌ها

ابتدا پروژه را از مخزن کد (Git Repository) کلون کرده و سپس وابستگی‌های آن را با دستور زیر نصب کنید:

```bash
# کلون کردن پروژه (در صورت نیاز)
# git clone <repository-url>
# cd <project-directory>

# نصب وابستگی‌ها
pnpm install
```

### ۲. پیکربندی متغیرهای محیطی

یک فایل به نام `.env.local` در ریشه پروژه خود ایجاد کنید. می‌توانید فایل `.env.example` (اگر وجود دارد) را کپی کرده و نام آن را تغییر دهید. سپس مقادیر زیر را در آن قرار دهید:

```env
# آدرس کامل سایت وردپرسی شما
WORDPRESS_URL="https://your-wordpress-site.com"

# هاست‌نیم سایت وردپرسی (برای بهینه‌سازی تصاویر)
WORDPRESS_HOSTNAME="your-wordpress-site.com"

# کلید مخفی برای وب‌هوک بازسازی صفحات (اختیاری)
WORDPRESS_WEBHOOK_SECRET="some-secret-for-revalidation"

# کلید مخفی JWT
# !!! این کلید باید دقیقاً همان کلیدی باشد که در wp-config.php تعریف کردید !!!
JWT_SECRET="your-super-secret-key"
```

- `WORDPRESS_URL`: آدرس کامل سایت وردپرس شما (با `https` یا `http`).
- `JWT_SECRET`: همان کلید مخفی که در مرحله قبل در فایل `wp-config.php` وردپرس تنظیم کردید.

### ۳. اجرای پروژه

پروژه را در حالت توسعه (Development) با دستور زیر اجرا کنید:

```bash
npm run dev
```

پس از اجرای موفقیت‌آمیز، پروژه شما بر روی آدرس `http://localhost:3000` در دسترس خواهد بود.

---

## نحوه استفاده از قابلیت لاگین

1.  به آدرس `http://localhost:3000/login` بروید.
2.  فرم لاگین برای شما نمایش داده می‌شود.
3.  نام کاربری و رمز عبور یکی از کاربران سایت وردپرسی خود را وارد کنید.
4.  در صورت موفقیت‌آمیز بودن لاگین، به صفحه اصلی هدایت می‌شوید و نام شما در بالای صفحه نمایش داده خواهد شد.

شما با موفقیت توانستید قابلیت لاگین با وردپرس را به پروژه Next.js خود اضافه کنید!
